define("local_cltools/local/table/tabulator-entity-lookup",["exports","core/notification","./repository"],(function(_exports,_notification,_repository){var obj;function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.prepareEntityLookup=_exports.entityLookup=void 0,_notification=(obj=_notification)&&obj.__esModule?obj:{default:obj};var computePrefix=function(entityclass,displayfield){return"entityLookup_"+entityclass+"_"+displayfield};_exports.entityLookup=function(entityclass,displayfield){var values=sessionStorage.getItem(computePrefix(entityclass,displayfield));return values?JSON.parse(values):[]};var fn,_ref,prepareEntityLookup=(fn=regeneratorRuntime.mark((function _callee(entityclass,displayfield){var lookupValues;return regeneratorRuntime.wrap((function(_context){for(;;)switch(_context.prev=_context.next){case 0:return window.onbeforeunload=function(){sessionStorage.removeItem(computePrefix(entityclass,displayfield))},_context.next=3,(0,_repository.entityTableLookup)({entityclass:entityclass,displayfield:displayfield}).catch(_notification.default.exception).then((function(result){return result.warnings&&0!==result.warnings.length?(_notification.default.addNotification({message:result.warnings.reduce((function(a,w){return a+" "+w.message}),"")}),[]):Object.fromEntries(result.values.map((function(_ref2){return[_ref2.id,_ref2.value]})))}));case 3:lookupValues=_context.sent,sessionStorage.setItem(computePrefix(entityclass,displayfield),JSON.stringify(lookupValues));case 5:case"end":return _context.stop()}}),_callee)})),_ref=function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))},function(_x,_x2){return _ref.apply(this,arguments)});_exports.prepareEntityLookup=prepareEntityLookup}));

//# sourceMappingURL=tabulator-entity-lookup.min.js.map